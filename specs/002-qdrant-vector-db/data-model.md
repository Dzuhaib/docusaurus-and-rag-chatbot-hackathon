# Data Model: Qdrant Vector Storage

**Purpose**: To define the structure of data stored within the Qdrant Cloud vector database collection. This includes the vector itself and the associated payload (metadata and original text).

## Qdrant Collection Structure

### Collection Name
- A single collection will be created, potentially named `docusaurus-book-content` or configurable via environment variables.

### Vector Size
- The dimensionality of the vectors will depend on the chosen Google Gemini embedding model. This will be determined during implementation based on the model's output.

### Payload Structure (JSON)

Each "point" (vector) in the Qdrant collection will have a payload associated with it, structured as follows:

```json
{
  "text": "string",            // The original text chunk from the Markdown file.
  "file_path": "string",       // Relative path to the source Markdown file (e.g., "docs/chapter1/subchapter1.md").
  "url": "string",             // The public URL to the source Docusaurus page (e.g., "/docs/chapter1/subchapter1").
  "chapter_title": "string",   // Title of the main chapter this chunk belongs to.
  "subchapter_title": "string",// Title of the specific subchapter this chunk belongs to.
  "chunk_id": "string",        // A unique identifier for the chunk within its file (e.g., based on hash or sequential number).
  "heading": "string",         // The nearest preceding heading for the chunk (optional).
  "page_title": "string"       // The title of the Markdown page (frontmatter title).
}
```

## Entities

### 1. Text Chunk (Payload Field)
- **Description**: A segment of text extracted from a Docusaurus Markdown file, carefully sized to be effective for embedding models.
- **Attributes**: `text` (string).

### 2. Vector Embedding (Qdrant Vector)
- **Description**: A high-dimensional numerical representation of the semantic meaning of a Text Chunk, generated by Google Gemini Embeddings.
- **Attributes**: `vector` (float array).

### 3. Metadata (Payload Fields)
- **Description**: Structured information providing context about the Text Chunk.
- **Attributes**: `file_path`, `url`, `chapter_title`, `subchapter_title`, `chunk_id`, `heading`, `page_title`.

## Indexing Strategy

- **Chunking**: Markdown files will be parsed and segmented into text chunks. The chunking strategy will aim to preserve semantic coherence within each chunk (e.g., chunk by paragraphs, sections, or a fixed token window with overlap).
- **Unique ID**: Each point in Qdrant will have a unique ID, potentially a hash of `file_path` and `chunk_id`.
- **Upsert Operation**: For re-indexing, new or updated chunks will be "upserted" (update if exists, insert if not) to ensure data freshness without duplication.
